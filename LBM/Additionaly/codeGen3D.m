syms ux uy uz r0 r1 r2 r3 r4 r5 r6 r7 r_cor f0 f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 real
syms f11 f12 f13 f14 f15 f16 f17 f18 f19 f20 f21 f22 f23 f24 f25 f26 real
syms f_t0 f_t1 f_t2 f_t3 f_t4 f_t5 f_t6 f_t7 f_t8 f_t9 f_t10 f_t11 f_t12 real
syms f_t13 f_t14 f_t15 f_t16 f_t17 f_t18 f_t19 f_t20 f_t21 f_t22 f_t23 f_t24 f_t25 f_t26 real
syms Fx Fy Fz rho real


x0=0-ux;
y0=0-uy;
z0=0-uz;

x1=1-ux;
y1=0-uy;
z1=0-uz;

x2=-1-ux;
y2=0-uy;
z2=0-uz;

x3=0-ux;
y3=1-uy;
z3=0-uz;

x4=0-ux;
y4=-1-uy;
z4=0-uz;

x5=0-ux;
y5=0-uy;
z5=1-uz;

x6=0-ux;
y6=0-uy;
z6=-1-uz;

x7=1-ux;
y7=1-uy;
z7=0-uz;
		
x8=-1-ux;
y8=-1-uy;
z8=0-uz;
		
x9=1-ux;
y9=0-uy;
z9=1-uz;

x10=-1-ux;
y10=0-uy;
z10=-1-uz;

x11=0-ux;
y11=1-uy;
z11=1-uz;

x12=0-ux;
y12=-1-uy;
z12=-1-uz;

x13=1-ux;
y13=-1-uy;
z13=0-uz;

x14=-1-ux;
y14=1-uy;
z14=0-uz;

x15=1-ux;
y15=0-uy;
z15=-1-uz;

x16=-1-ux;
y16=0-uy;
z16=1-uz;

x17=0-ux;
y17=1-uy;
z17=-1-uz;

x18=0-ux;
y18=-1-uy;
z18=1-uz;

x19=1 -ux;
y19=1-uy;
z19=1-uz;

x20=-1-ux;
y20=-1-uy;
z20=-1-uz;

x21=1-ux;
y21=1-uy;
z21=-1-uz;

x22=-1-ux;
y22=-1-uy;
z22=1-uz;

x23=1-ux;
y23=-1-uy;
z23=1-uz;

x24=-1-ux;
y24=1-uy;
z24=-1-uz;

x25=-1-ux;
y25=1-uy;
z25=1-uz;

x26=1-ux;
y26=-1-uy;
z26=-1-uz;


M=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1;
x0,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18,x19,x20,x21,x22,x23,x24,x25,x26;
y0,y1,y2,y3,y4,y5,y6,y7,y8,y9,y10,y11,y12,y13,y14,y15,y16,y17,y18,y19,y20,y21,y22,y23,y24,y25,y26;
z0,z1,z2,z3,z4,z5,z6,z7,z8,z9,z10,z11,z12,z13,z14,z15,z16,z17,z18,z19,z20,z21,z22,z23,z24,z25,z26;
x0*y0,x1*y1,x2*y2,x3*y3,x4*y4,x5*y5,x6*y6,x7*y7,x8*y8,x9*y9,x10*y10,x11*y11,x12*y12,x13*y13,x14*y14,x15*y15,x16*y16,x17*y17,x18*y18,x19*y19,x20*y20,x21*y21,x22*y22,x23*y23,x24*y24,x25*y25,x26*y26;
x0*z0,x1*z1,x2*z2,x3*z3,x4*z4,x5*z5,x6*z6,x7*z7,x8*z8,x9*z9,x10*z10,x11*z11,x12*z12,x13*z13,x14*z14,x15*z15,x16*z16,x17*z17,x18*z18,x19*z19,x20*z20,x21*z21,x22*z22,x23*z23,x24*z24,x25*z25,x26*z26;
y0*z0,y1*z1,y2*z2,y3*z3,y4*z4,y5*z5,y6*z6,y7*z7,y8*z8,y9*z9,y10*z10,y11*z11,y12*z12,y13*z13,y14*z14,y15*z15,y16*z16,y17*z17,y18*z18,y19*z19,y20*z20,y21*z21,y22*z22,y23*z23,y24*z24,y25*z25,y26*z26;
x0^2-y0^2,x1^2-y1^2,x2^2-y2^2,x3^2-y3^2,x4^2-y4^2,x5^2-y5^2,x6^2-y6^2,x7^2-y7^2,x8^2-y8^2,x9^2-y9^2,x10^2-y10^2,x11^2-y11^2,x12^2-y12^2,x13^2-y13^2,x14^2-y14^2,x15^2-y15^2,x16^2-y16^2,x17^2-y17^2,x18^2-y18^2,x19^2-y19^2,x20^2-y20^2,x21^2-y21^2,x22^2-y22^2,x23^2-y23^2,x24^2-y24^2,x25^2-y25^2,x26^2-y26^2;
x0^2-z0^2,x1^2-z1^2,x2^2-z2^2,x3^2-z3^2,x4^2-z4^2,x5^2-z5^2,x6^2-z6^2,x7^2-z7^2,x8^2-z8^2,x9^2-z9^2,x10^2-z10^2,x11^2-z11^2,x12^2-z12^2,x13^2-z13^2,x14^2-z14^2,x15^2-z15^2,x16^2-z16^2,x17^2-z17^2,x18^2-z18^2,x19^2-z19^2,x20^2-z20^2,x21^2-z21^2,x22^2-z22^2,x23^2-z23^2,x24^2-z24^2,x25^2-z25^2,x26^2-z26^2;
x0^2+y0^2+z0^2,x1^2+y1^2+z1^2,x2^2+y2^2+z2^2,x3^2+y3^2+z3^2,x4^2+y4^2+z4^2,x5^2+y5^2+z5^2,x6^2+y6^2+z6^2,x7^2+y7^2+z7^2,x8^2+y8^2+z8^2,x9^2+y9^2+z9^2,x10^2+y10^2+z10^2,x11^2+y11^2+z11^2,x12^2+y12^2+z12^2,x13^2+y13^2+z13^2,x14^2+y14^2+z14^2,x15^2+y15^2+z15^2,x16^2+y16^2+z16^2,x17^2+y17^2+z17^2,x18^2+y18^2+z18^2,x19^2+y19^2+z19^2,x20^2+y20^2+z20^2,x21^2+y21^2+z21^2,x22^2+y22^2+z22^2,x23^2+y23^2+z23^2,x24^2+y24^2+z24^2,x25^2+y25^2+z25^2,x26^2+y26^2+z26^2;
x0*y0^2+x0*z0^2,x1*y1^2+x1*z1^2,x2*y2^2+x2*z2^2,x3*y3^2+x3*z3^2,x4*y4^2+x4*z4^2,x5*y5^2+x5*z5^2,x6*y6^2+x6*z6^2,x7*y7^2+x7*z7^2,x8*y8^2+x8*z8^2,x9*y9^2+x9*z9^2,x10*y10^2+x10*z10^2,x11*y11^2+x11*z11^2,x12*y12^2+x12*z12^2,x13*y13^2+x13*z13^2,x14*y14^2+x14*z14^2,x15*y15^2+x15*z15^2,x16*y16^2+x16*z16^2,x17*y17^2+x17*z17^2,x18*y18^2+x18*z18^2,x19*y19^2+x19*z19^2,x20*y20^2+x20*z20^2,x21*y21^2+x21*z21^2,x22*y22^2+x22*z22^2,x23*y23^2+x23*z23^2,x24*y24^2+x24*z24^2,x25*y25^2+x25*z25^2,x26*y26^2+x26*z26^2;
y0*x0^2+y0*z0^2,y1*x1^2+y1*z1^2,y2*x2^2+y2*z2^2,y3*x3^2+y3*z3^2,y4*x4^2+y4*z4^2,y5*x5^2+y5*z5^2,y6*x6^2+y6*z6^2,y7*x7^2+y7*z7^2,y8*x8^2+y8*z8^2,y9*x9^2+y9*z9^2,y10*x10^2+y10*z10^2,y11*x11^2+y11*z11^2,y12*x12^2+y12*z12^2,y13*x13^2+y13*z13^2,y14*x14^2+y14*z14^2,y15*x15^2+y15*z15^2,y16*x16^2+y16*z16^2,y17*x17^2+y17*z17^2,y18*x18^2+y18*z18^2,y19*x19^2+y19*z19^2,y20*x20^2+y20*z20^2,y21*x21^2+y21*z21^2,y22*x22^2+y22*z22^2,y23*x23^2+y23*z23^2,y24*x24^2+y24*z24^2,y25*x25^2+y25*z25^2,y26*x26^2+y26*z26^2;
z0*x0^2+z0*y0^2,z1*x1^2+z1*y1^2,z2*x2^2+z2*y2^2,z3*x3^2+z3*y3^2,z4*x4^2+z4*y4^2,z5*x5^2+z5*y5^2,z6*x6^2+z6*y6^2,z7*x7^2+z7*y7^2,z8*x8^2+z8*y8^2,z9*x9^2+z9*y9^2,z10*x10^2+z10*y10^2,z11*x11^2+z11*y11^2,z12*x12^2+z12*y12^2,z13*x13^2+z13*y13^2,z14*x14^2+z14*y14^2,z15*x15^2+z15*y15^2,z16*x16^2+z16*y16^2,z17*x17^2+z17*y17^2,z18*x18^2+z18*y18^2,z19*x19^2+z19*y19^2,z20*x20^2+z20*y20^2,z21*x21^2+z21*y21^2,z22*x22^2+z22*y22^2,z23*x23^2+z23*y23^2,z24*x24^2+z24*y24^2,z25*x25^2+z25*y25^2,z26*x26^2+z26*y26^2;
x0*y0^2-x0*z0^2,x1*y1^2-x1*z1^2,x2*y2^2-x2*z2^2,x3*y3^2-x3*z3^2,x4*y4^2-x4*z4^2,x5*y5^2-x5*z5^2,x6*y6^2-x6*z6^2,x7*y7^2-x7*z7^2,x8*y8^2-x8*z8^2,x9*y9^2-x9*z9^2,x10*y10^2-x10*z10^2,x11*y11^2-x11*z11^2,x12*y12^2-x12*z12^2,x13*y13^2-x13*z13^2,x14*y14^2-x14*z14^2,x15*y15^2-x15*z15^2,x16*y16^2-x16*z16^2,x17*y17^2-x17*z17^2,x18*y18^2-x18*z18^2,x19*y19^2-x19*z19^2,x20*y20^2-x20*z20^2,x21*y21^2-x21*z21^2,x22*y22^2-x22*z22^2,x23*y23^2-x23*z23^2,x24*y24^2-x24*z24^2,x25*y25^2-x25*z25^2,x26*y26^2-x26*z26^2;
y0*x0^2-y0*z0^2,y1*x1^2-y1*z1^2,y2*x2^2-y2*z2^2,y3*x3^2-y3*z3^2,y4*x4^2-y4*z4^2,y5*x5^2-y5*z5^2,y6*x6^2-y6*z6^2,y7*x7^2-y7*z7^2,y8*x8^2-y8*z8^2,y9*x9^2-y9*z9^2,y10*x10^2-y10*z10^2,y11*x11^2-y11*z11^2,y12*x12^2-y12*z12^2,y13*x13^2-y13*z13^2,y14*x14^2-y14*z14^2,y15*x15^2-y15*z15^2,y16*x16^2-y16*z16^2,y17*x17^2-y17*z17^2,y18*x18^2-y18*z18^2,y19*x19^2-y19*z19^2,y20*x20^2-y20*z20^2,y21*x21^2-y21*z21^2,y22*x22^2-y22*z22^2,y23*x23^2-y23*z23^2,y24*x24^2-y24*z24^2,y25*x25^2-y25*z25^2,y26*x26^2-y26*z26^2;
z0*x0^2-z0*y0^2,z1*x1^2-z1*y1^2,z2*x2^2-z2*y2^2,z3*x3^2-z3*y3^2,z4*x4^2-z4*y4^2,z5*x5^2-z5*y5^2,z6*x6^2-z6*y6^2,z7*x7^2-z7*y7^2,z8*x8^2-z8*y8^2,z9*x9^2-z9*y9^2,z10*x10^2-z10*y10^2,z11*x11^2-z11*y11^2,z12*x12^2-z12*y12^2,z13*x13^2-z13*y13^2,z14*x14^2-z14*y14^2,z15*x15^2-z15*y15^2,z16*x16^2-z16*y16^2,z17*x17^2-z17*y17^2,z18*x18^2-z18*y18^2,z19*x19^2-z19*y19^2,z20*x20^2-z20*y20^2,z21*x21^2-z21*y21^2,z22*x22^2-z22*y22^2,z23*x23^2-z23*y23^2,z24*x24^2-z24*y24^2,z25*x25^2-z25*y25^2,z26*x26^2-z26*y26^2;
x0*y0*z0,x1*y1*z1,x2*y2*z2,x3*y3*z3,x4*y4*z4,x5*y5*z5,x6*y6*z6,x7*y7*z7,x8*y8*z8,x9*y9*z9,x10*y10*z10,x11*y11*z11,x12*y12*z12,x13*y13*z13,x14*y14*z14,x15*y15*z15,x16*y16*z16,x17*y17*z17,x18*y18*z18,x19*y19*z19,x20*y20*z20,x21*y21*z21,x22*y22*z22,x23*y23*z23,x24*y24*z24,x25*y25*z25,x26*y26*z26;
x0^2*y0^2+x0^2*z0^2+y0^2*z0^2,x1^2*y1^2+x1^2*z1^2+y1^2*z1^2,x2^2*y2^2+x2^2*z2^2+y2^2*z2^2,x3^2*y3^2+x3^2*z3^2+y3^2*z3^2,x4^2*y4^2+x4^2*z4^2+y4^2*z4^2,x5^2*y5^2+x5^2*z5^2+y5^2*z5^2,x6^2*y6^2+x6^2*z6^2+y6^2*z6^2,x7^2*y7^2+x7^2*z7^2+y7^2*z7^2,x8^2*y8^2+x8^2*z8^2+y8^2*z8^2,x9^2*y9^2+x9^2*z9^2+y9^2*z9^2,x10^2*y10^2+x10^2*z10^2+y10^2*z10^2,x11^2*y11^2+x11^2*z11^2+y11^2*z11^2,x12^2*y12^2+x12^2*z12^2+y12^2*z12^2,x13^2*y13^2+x13^2*z13^2+y13^2*z13^2,x14^2*y14^2+x14^2*z14^2+y14^2*z14^2,x15^2*y15^2+x15^2*z15^2+y15^2*z15^2,x16^2*y16^2+x16^2*z16^2+y16^2*z16^2,x17^2*y17^2+x17^2*z17^2+y17^2*z17^2,x18^2*y18^2+x18^2*z18^2+y18^2*z18^2,x19^2*y19^2+x19^2*z19^2+y19^2*z19^2,x20^2*y20^2+x20^2*z20^2+y20^2*z20^2,x21^2*y21^2+x21^2*z21^2+y21^2*z21^2,x22^2*y22^2+x22^2*z22^2+y22^2*z22^2,x23^2*y23^2+x23^2*z23^2+y23^2*z23^2,x24^2*y24^2+x24^2*z24^2+y24^2*z24^2,x25^2*y25^2+x25^2*z25^2+y25^2*z25^2,x26^2*y26^2+x26^2*z26^2+y26^2*z26^2;
x0^2*y0^2+x0^2*z0^2-y0^2*z0^2,x1^2*y1^2+x1^2*z1^2-y1^2*z1^2,x2^2*y2^2+x2^2*z2^2-y2^2*z2^2,x3^2*y3^2+x3^2*z3^2-y3^2*z3^2,x4^2*y4^2+x4^2*z4^2-y4^2*z4^2,x5^2*y5^2+x5^2*z5^2-y5^2*z5^2,x6^2*y6^2+x6^2*z6^2-y6^2*z6^2,x7^2*y7^2+x7^2*z7^2-y7^2*z7^2,x8^2*y8^2+x8^2*z8^2-y8^2*z8^2,x9^2*y9^2+x9^2*z9^2-y9^2*z9^2,x10^2*y10^2+x10^2*z10^2-y10^2*z10^2,x11^2*y11^2+x11^2*z11^2-y11^2*z11^2,x12^2*y12^2+x12^2*z12^2-y12^2*z12^2,x13^2*y13^2+x13^2*z13^2-y13^2*z13^2,x14^2*y14^2+x14^2*z14^2-y14^2*z14^2,x15^2*y15^2+x15^2*z15^2-y15^2*z15^2,x16^2*y16^2+x16^2*z16^2-y16^2*z16^2,x17^2*y17^2+x17^2*z17^2-y17^2*z17^2,x18^2*y18^2+x18^2*z18^2-y18^2*z18^2,x19^2*y19^2+x19^2*z19^2-y19^2*z19^2,x20^2*y20^2+x20^2*z20^2-y20^2*z20^2,x21^2*y21^2+x21^2*z21^2-y21^2*z21^2,x22^2*y22^2+x22^2*z22^2-y22^2*z22^2,x23^2*y23^2+x23^2*z23^2-y23^2*z23^2,x24^2*y24^2+x24^2*z24^2-y24^2*z24^2,x25^2*y25^2+x25^2*z25^2-y25^2*z25^2,x26^2*y26^2+x26^2*z26^2-y26^2*z26^2;
x0^2*y0^2-x0^2*z0^2,x1^2*y1^2-x1^2*z1^2,x2^2*y2^2-x2^2*z2^2,x3^2*y3^2-x3^2*z3^2,x4^2*y4^2-x4^2*z4^2,x5^2*y5^2-x5^2*z5^2,x6^2*y6^2-x6^2*z6^2,x7^2*y7^2-x7^2*z7^2,x8^2*y8^2-x8^2*z8^2,x9^2*y9^2-x9^2*z9^2,x10^2*y10^2-x10^2*z10^2,x11^2*y11^2-x11^2*z11^2,x12^2*y12^2-x12^2*z12^2,x13^2*y13^2-x13^2*z13^2,x14^2*y14^2-x14^2*z14^2,x15^2*y15^2-x15^2*z15^2,x16^2*y16^2-x16^2*z16^2,x17^2*y17^2-x17^2*z17^2,x18^2*y18^2-x18^2*z18^2,x19^2*y19^2-x19^2*z19^2,x20^2*y20^2-x20^2*z20^2,x21^2*y21^2-x21^2*z21^2,x22^2*y22^2-x22^2*z22^2,x23^2*y23^2-x23^2*z23^2,x24^2*y24^2-x24^2*z24^2,x25^2*y25^2-x25^2*z25^2,x26^2*y26^2-x26^2*z26^2;
x0^2*y0*z0,x1^2*y1*z1,x2^2*y2*z2,x3^2*y3*z3,x4^2*y4*z4,x5^2*y5*z5,x6^2*y6*z6,x7^2*y7*z7,x8^2*y8*z8,x9^2*y9*z9,x10^2*y10*z10,x11^2*y11*z11,x12^2*y12*z12,x13^2*y13*z13,x14^2*y14*z14,x15^2*y15*z15,x16^2*y16*z16,x17^2*y17*z17,x18^2*y18*z18,x19^2*y19*z19,x20^2*y20*z20,x21^2*y21*z21,x22^2*y22*z22,x23^2*y23*z23,x24^2*y24*z24,x25^2*y25*z25,x26^2*y26*z26;
x0*y0^2*z0,x1*y1^2*z1,x2*y2^2*z2,x3*y3^2*z3,x4*y4^2*z4,x5*y5^2*z5,x6*y6^2*z6,x7*y7^2*z7,x8*y8^2*z8,x9*y9^2*z9,x10*y10^2*z10,x11*y11^2*z11,x12*y12^2*z12,x13*y13^2*z13,x14*y14^2*z14,x15*y15^2*z15,x16*y16^2*z16,x17*y17^2*z17,x18*y18^2*z18,x19*y19^2*z19,x20*y20^2*z20,x21*y21^2*z21,x22*y22^2*z22,x23*y23^2*z23,x24*y24^2*z24,x25*y25^2*z25,x26*y26^2*z26;
x0*y0*z0^2,x1*y1*z1^2,x2*y2*z2^2,x3*y3*z3^2,x4*y4*z4^2,x5*y5*z5^2,x6*y6*z6^2,x7*y7*z7^2,x8*y8*z8^2,x9*y9*z9^2,x10*y10*z10^2,x11*y11*z11^2,x12*y12*z12^2,x13*y13*z13^2,x14*y14*z14^2,x15*y15*z15^2,x16*y16*z16^2,x17*y17*z17^2,x18*y18*z18^2,x19*y19*z19^2,x20*y20*z20^2,x21*y21*z21^2,x22*y22*z22^2,x23*y23*z23^2,x24*y24*z24^2,x25*y25*z25^2,x26*y26*z26^2;
x0*y0^2*z0^2,x1*y1^2*z1^2,x2*y2^2*z2^2,x3*y3^2*z3^2,x4*y4^2*z4^2,x5*y5^2*z5^2,x6*y6^2*z6^2,x7*y7^2*z7^2,x8*y8^2*z8^2,x9*y9^2*z9^2,x10*y10^2*z10^2,x11*y11^2*z11^2,x12*y12^2*z12^2,x13*y13^2*z13^2,x14*y14^2*z14^2,x15*y15^2*z15^2,x16*y16^2*z16^2,x17*y17^2*z17^2,x18*y18^2*z18^2,x19*y19^2*z19^2,x20*y20^2*z20^2,x21*y21^2*z21^2,x22*y22^2*z22^2,x23*y23^2*z23^2,x24*y24^2*z24^2,x25*y25^2*z25^2,x26*y26^2*z26^2;
x0^2*y0*z0^2,x1^2*y1*z1^2,x2^2*y2*z2^2,x3^2*y3*z3^2,x4^2*y4*z4^2,x5^2*y5*z5^2,x6^2*y6*z6^2,x7^2*y7*z7^2,x8^2*y8*z8^2,x9^2*y9*z9^2,x10^2*y10*z10^2,x11^2*y11*z11^2,x12^2*y12*z12^2,x13^2*y13*z13^2,x14^2*y14*z14^2,x15^2*y15*z15^2,x16^2*y16*z16^2,x17^2*y17*z17^2,x18^2*y18*z18^2,x19^2*y19*z19^2,x20^2*y20*z20^2,x21^2*y21*z21^2,x22^2*y22*z22^2,x23^2*y23*z23^2,x24^2*y24*z24^2,x25^2*y25*z25^2,x26^2*y26*z26^2;
x0^2*y0^2*z0,x1^2*y1^2*z1,x2^2*y2^2*z2,x3^2*y3^2*z3,x4^2*y4^2*z4,x5^2*y5^2*z5,x6^2*y6^2*z6,x7^2*y7^2*z7,x8^2*y8^2*z8,x9^2*y9^2*z9,x10^2*y10^2*z10,x11^2*y11^2*z11,x12^2*y12^2*z12,x13^2*y13^2*z13,x14^2*y14^2*z14,x15^2*y15^2*z15,x16^2*y16^2*z16,x17^2*y17^2*z17,x18^2*y18^2*z18,x19^2*y19^2*z19,x20^2*y20^2*z20,x21^2*y21^2*z21,x22^2*y22^2*z22,x23^2*y23^2*z23,x24^2*y24^2*z24,x25^2*y25^2*z25,x26^2*y26^2*z26;
x0^2*y0^2*z0^2,x1^2*y1^2*z1^2,x2^2*y2^2*z2^2,x3^2*y3^2*z3^2,x4^2*y4^2*z4^2,x5^2*y5^2*z5^2,x6^2*y6^2*z6^2,x7^2*y7^2*z7^2,x8^2*y8^2*z8^2,x9^2*y9^2*z9^2,x10^2*y10^2*z10^2,x11^2*y11^2*z11^2,x12^2*y12^2*z12^2,x13^2*y13^2*z13^2,x14^2*y14^2*z14^2,x15^2*y15^2*z15^2,x16^2*y16^2*z16^2,x17^2*y17^2*z17^2,x18^2*y18^2*z18^2,x19^2*y19^2*z19^2,x20^2*y20^2*z20^2,x21^2*y21^2*z21^2,x22^2*y22^2*z22^2,x23^2*y23^2*z23^2,x24^2*y24^2*z24^2,x25^2*y25^2*z25^2,x26^2*y26^2*z26^2];

I=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];


D=[r0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,r1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,r1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,r1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,r2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,r2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,r2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,r2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,r2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,r3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r4,0,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r5,0,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r6,0,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r6,0,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r6,0;
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r7];


cs_sq = 1.0/3.0;

f_dist=[f0, f1, f2, f3, f4, f5, f6, f7, f8, f9, f10, f11, f12, f13, f14, f15, f16, f17, f18, f19, f20, f21, f22, f23, f24, f25, f26];

m_eq=[rho, 0, 0, 0, 0, 0, 0, 0, 0, rho, 0, 0, 0, 0, 0, 0, 0, rho*cs_sq, rho*cs_sq*cs_sq, 0, 0, 0, 0, 0, 0, 0, rho*cs_sq*cs_sq*cs_sq];

R=[0, Fx, Fy, Fz, 0, 0, 0, 0, 0, 0, 2*cs_sq*Fx, 2*cs_sq*Fy, 2*cs_sq*Fz, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, cs_sq*cs_sq*Fx, cs_sq*cs_sq*Fy, cs_sq*cs_sq*Fz, 0];

f_dist=f_dist';
m_eq = m_eq';
R=R';

M_inv=inv(M);
f_tilde = D*(M*f_dist-m_eq);
f_r = (I-D/2)*R;

fileID = fopen('3DFormel.txt','w');

fprintf(fileID,'%s\n\n', char(ccode(f_tilde)));

f_tilde=[f_t0, f_t1, f_t2, f_t3, f_t4, f_t5, f_t6, f_t7, f_t8, f_t9, f_t10, f_t11, f_t12, f_t13, f_t14, f_t15, f_t16, f_t17, f_t18, f_t19, f_t20, f_t21, f_t22, f_t23, f_t24, f_t25, f_t26];
f_tilde = f_tilde';

Omega=-M_inv*f_tilde;
G=M_inv*f_r;

fprintf(fileID,'%s\n\n', char(ccode(Omega)));
fprintf(fileID,'%s\n\n', char(ccode(G)));


%f_star = f_dist + Omega + G;
fclose(fileID);
